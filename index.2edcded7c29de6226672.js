(()=>{"use strict";function t(t,e){var n=t&&"number"==typeof t?t:0,r=e&&"number"==typeof e?e:0;return Math.floor(Math.random()*(r-n)+n)}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function i(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var o=new WeakSet;function a(){this.interval=null,this.isGameOver=!1,this.isPaused=!1,this.canMove=!0}const s=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,o),i(o,this,a).call(this)},(e=[{key:"start",value:function(){this.isGameOver&&this.clear(),this.isPaused=!1,this.canMove=!0}},{key:"stop",value:function(){this.isPaused=!0,this.canMove=!1,clearTimeout(this.interval)}},{key:"setGameOver",value:function(){this.isGameOver=!0,this.stop()}},{key:"clear",value:function(){this.stop(),i(o,this,a).call(this)}}])&&n(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}const h=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.EMPTY_VALUE=void 0!==r?r:0,i&&Array.isArray(i)?(this.value=this.generate(i.length,i[0].length,this.EMPTY_VALUE),this.insert(i,{x:0,y:0})):this.value=this.generate(e,n,this.EMPTY_VALUE)}return e=t,n=[{key:"generate",value:function(t,e,n){for(var r=t&&"number"==typeof t?Math.abs(Math.trunc(t)):1,i=e&&"number"==typeof e?Math.abs(Math.trunc(e)):1,o=void 0!==n?n:0,a=new Array,s=0;s<r;s++){a[s]=new Array;for(var c=0;c<i;c++)a[s][c]=o}return a}},{key:"clone",value:function(){return new t(null,null,this.EMPTY_VALUE,this.copy())}},{key:"copy",value:function(){for(var t=this.generate(this.value.length,this.value[0].length,this.EMPTY_VALUE),e=0;e<this.value.length;e++)for(var n=0;n<this.value[e].length;n++)t[e][n]=this.value[e][n];return t}},{key:"crop",value:function(t,e){for(var n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=this.generate(n,r,this.EMPTY_VALUE),o=0;o<n;o++)for(var a=0;a<r;a++){var s=t.x+o,c=t.y+a;i[o][a]=this.value[s][c]}this.value=i}},{key:"insert",value:function(t,e){for(var n=this.copy(),r=e.x,i=0;i<t.length;i++){for(var o=e.y,a=0;a<t[i].length;a++)n[r][o]=t[i][a],o++;r++}this.value=n}},{key:"reflectX",value:function(){this.value.reverse()}},{key:"reflectY",value:function(){this.value.forEach(function(t){t.reverse()})}},{key:"rotateLeft",value:function(){for(var t=this.generate(this.value[0].length,this.value.length,this.EMPTY_VALUE),e=0;e<this.value.length;e++)for(var n=0;n<this.value[e].length;n++){var r=e;t[this.value[e].length-1-n][r]=this.value[e][n]}this.value=t}},{key:"rotateRight",value:function(){for(var t=this.generate(this.value[0].length,this.value.length,this.EMPTY_VALUE),e=0;e<this.value.length;e++)for(var n=0;n<this.value[e].length;n++){var r=n,i=this.value.length-1-e;t[r][i]=this.value[e][n]}this.value=t}}],n&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function v(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}function m(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var p=new WeakSet;function b(){var t=this;this.$container.innerHTML="",this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.$container.appendChild(this.canvas),m(p,this,d).call(this),window.addEventListener("resize",function(){return m(p,t,d).call(t)}),this.media=window.matchMedia("(prefers-color-scheme: dark)"),m(p,this,w).call(this,this.media),this.media.addEventListener("change",function(){return m(p,t,w).call(t,t.media)})}function d(){var t=this.matrix.length,e=this.matrix[0].length,n=e/t;this.canvas.width=0,this.canvas.height=0,this.canvas.width=this.$container.offsetWidth,this.canvas.height=this.canvas.width*n,this.cellWidth=this.canvas.width/t,this.cellHeight=this.canvas.height/e,this.draw()}function w(t){t.matches?this.theme="dark":this.theme="light",this.draw()}const g=function(){return t=function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,p),!e||!n)return this.error="Error on construct",this;this.$container=e,this.matrix=n,m(p,this,b).call(this)},(e=[{key:"draw",value:function(){if(!this.$container||!this.matrix)return this.error;this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<this.matrix.length;t++)for(var e=0;e<this.matrix[t].length;e++)this.context.fillStyle=this.matrix[t][e].color[this.theme],this.context.fillRect(t*this.cellWidth,e*this.cellHeight,this.cellWidth,this.cellHeight)}}])&&y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,E(r.key),r)}}function E(t){var e=function(t){if("object"!=S(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:e+""}const _=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e&&"number"==typeof e?e:0},(e=[{key:"value",get:function(){return this._value},set:function(t){t&&"number"==typeof t&&(this._value=t)}},{key:"increase",value:function(t){this._value+=t&&"number"==typeof t?t:1}},{key:"decrease",value:function(t){this._value-=t&&"number"==typeof t?t:1}},{key:"reset",value:function(){this._value=0}}])&&T(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,k(r.key),r)}}function k(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}function j(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var R=new WeakSet;function M(){this._timeStart=Date.now(),this._timeNow=this._timeStart,this._value="00:00"}function O(){this._timeNow=Date.now();var t=this._timeNow-this._timeStart,e=Math.floor(t/1e3),n=0;e>=60&&(e-=60*(n=Math.floor(e/60))),n=n<10?"0".concat(n):"".concat(n),e=e<10?"0".concat(e):"".concat(e),this._value="".concat(n,":").concat(e)}const L=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,R),j(R,this,M).call(this)},(e=[{key:"value",get:function(){return j(R,this,O).call(this),this._value}},{key:"reset",value:function(){j(R,this,M).call(this)}}])&&x(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I(r.key),r)}}function I(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}function D(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var G=new WeakSet,Y=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,G),this._key=e,this._value=[],D(G,this,W).call(this)},e=[{key:"value",get:function(){return D(G,this,W).call(this),this._value}},{key:"add",value:function(t,e){if(t&&"number"==typeof t&&e&&"string"==typeof e){var n={date:Date.now(),score:t,time:e};this._value.push(n),D(G,this,H).call(this),D(G,this,N).call(this)}}},{key:"clean",value:function(){this._value=[],D(G,this,N).call(this)}}],e&&A(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function H(){this._value.sort(function(t,e){return t.score<e.score?1:t.score>e.score?-1:void 0})}function N(){localStorage.setItem(this._key,JSON.stringify(this._value))}function W(){localStorage[this._key]?this._value=JSON.parse(localStorage[this._key]):this._value=[],D(G,this,H).call(this)}const $=Y;function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,z(r.key),r)}}function B(t,e,n){return e&&V(t.prototype,e),n&&V(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function z(t){var e=function(t){if("object"!=U(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}var K=new WeakSet;function F(){var t=this;window.addEventListener("keydown",function(e){t._context.isGameOver||("ArrowLeft"===e.code||"KeyA"===e.code?t._context.moveToLeft():"ArrowUp"===e.code||"KeyW"===e.code?t._context.rotate():"ArrowRight"===e.code||"KeyD"===e.code?t._context.moveToRight():"ArrowDown"!==e.code&&"KeyS"!==e.code||t._context.moveToDown()),"KeyR"===e.code&&(t._context.clear(),t._context.start()),"KeyP"===e.code&&(t._context.isGameOver||(t._context.isPaused?t._context.start():t._context.stop()))})}const X=B(function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,r=K),r.add(n),this._context=e,function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(K,this,F).call(this)});function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tt(r.key),r)}}function Z(t,e,n){return e&&Q(t.prototype,e),n&&Q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tt(t){var e=function(t){if("object"!=q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==q(e)?e:e+""}function et(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nt=new WeakSet;function rt(){et(nt,this,at).call(this)&&(this.LISTENER_INTERRUPT=10,this.KEYPRESS_INTERRUPT=250,this._gamepadInterval=null,this._keypressCooldown=0,et(nt,this,it).call(this))}function it(){var t=this;window.addEventListener("gamepadconnected",function(){t._gamepadInterval=setInterval(function(){t._keypressCooldown+=t.LISTENER_INTERRUPT;var e,n,r=(e=navigator.getGamepads(),n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){l=!0,i=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,n)||function(t,e){if(t){if("string"==typeof t)return J(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],i=!1,o=null;r.buttons.forEach(function(t,e){1===t.value&&(o=e,i=!0)}),i&&et(nt,t,ot).call(t,o)},t.LISTENER_INTERRUPT)})}function ot(t){this._keypressCooldown>=this.KEYPRESS_INTERRUPT&&(8===t&&(this._context.isPaused?(this._context.start(),this._keypressCooldown=0):(this._context.stop(),this._keypressCooldown=0)),9===t&&(this._context.clear(),this._context.start(),this._keypressCooldown=0),0===t&&(this._context.rotate(),this._keypressCooldown=0),13===t&&(this._context.moveToDown(),this._keypressCooldown=0),14===t&&(this._context.moveToLeft(),this._keypressCooldown=0),15===t&&(this._context.moveToRight(),this._keypressCooldown=0))}function at(){return"getGamepads"in window.navigator}const st=Z(function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,r=nt),r.add(n),this._context=e,et(nt,this,rt).call(this)});function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ht(r.key),r)}}function ut(t,e,n){return e&&lt(t.prototype,e),n&&lt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ht(t){var e=function(t){if("object"!=ct(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ct(e)?e:e+""}var ft=new WeakSet;function yt(){var t=this,e=0,n=0;this._container.addEventListener("touchstart",function(t){e=t.touches[0].pageX,n=t.touches[0].pageY}),this._container.addEventListener("touchend",function(r){var i=r.changedTouches[0].pageX,o=r.changedTouches[0].pageY,a=i-e,s=o-n,c=Math.abs(a)>Math.abs(s),l=Math.abs(s)>Math.abs(a);a>0&&c?t._context.moveToRight():a<0&&c?t._context.moveToLeft():s>0&&l?t._context.moveToDown():s<0&&l&&t._context.rotate()})}const vt=ut(function t(e,n){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(r=this,i=ft),i.add(r),this._context=e,this._container=n,function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(ft,this,yt).call(this)}),mt=JSON.parse("[[[1,1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]],[[0,1,0],[1,1,1]]]"),pt=JSON.parse('[{"light":"#D93B23","dark":"#992A18"},{"light":"#D99E23","dark":"#BF8C1F"},{"light":"#FFCB5C","dark":"#FFC342"},{"light":"#02D978","dark":"#018C4D"},{"light":"#25D2E6","dark":"#23C7D9"},{"light":"#240BB3","dark":"#240BB3"},{"light":"#8932B8","dark":"#8932B8"}]');function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t){if("object"!=bt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=bt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bt(e)?e:e+""}function gt(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var St=new WeakSet;function Tt(){return new h(null,null,this.empty,gt(St,this,Et).call(this))}function Et(){var t=this;return mt[this.type].map(function(e){return e.map(function(e){return 0===e?t.empty:{exist:!0,color:{light:t.color.light,dark:t.color.dark}}})})}const _t=function(){return t=function t(e){var n=e.type,r=void 0===n?null:n,i=e.color,o=void 0===i?null:i,a=e.column,s=void 0===a?5:a,c=e.row,l=void 0===c?21:c,u=e.empty,h=void 0===u?null:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,St),this.type=r,this.color=pt[o],this.column=s,this.row=l,this.empty=h,this.matrix=gt(St,this,Tt).call(this)},(e=[{key:"toLeft",value:function(){this.column--}},{key:"toRight",value:function(){this.column++}},{key:"toDown",value:function(){this.row--}},{key:"rotateLeft",value:function(){this.matrix.rotateLeft()}},{key:"rotateRight",value:function(){this.matrix.rotateRight()}}])&&dt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kt(r.key),r)}}function kt(t){var e=function(t){if("object"!=Pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pt(e)?e:e+""}function jt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(jt=function(){return!!t})()}function Rt(t,e,n,r){var i=Mt(Ot(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function Mt(){return Mt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Ot(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mt.apply(null,arguments)}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}function Lt(t,e){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lt(t,e)}function Ct(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var At=new WeakSet,It=function(e){function n(t){var e,r,i,o,a,s,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(c=function(t,e,n){return e=Ot(e),function(t,e){if(e&&("object"==Pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,jt()?Reflect.construct(e,n||[],Ot(t).constructor):e.apply(t,n))}(this,n),At),c._params=t,c.SPEED_RATE=null!==(e=c._params)&&void 0!==e&&e.speedRate&&"number"==typeof(null===(r=c._params)||void 0===r?void 0:r.speedRate)?null===(i=c._params)||void 0===i?void 0:i.speedRate:250,c.KEY_RATING=null!==(o=c._params)&&void 0!==o&&o.keyRating&&"string"==typeof(null===(a=c._params)||void 0===a?void 0:a.keyRating)?null===(s=c._params)||void 0===s?void 0:s.keyRating:"tetris",Ct(At,c,Ut).call(c),Ct(At,c,$t).call(c),Ct(At,c,Wt).call(c),Ct(At,c,Dt).call(c),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}(n,e),r=n,i=[{key:"getTetromino",value:function(){return new _t({type:t(0,7),color:t(0,7),empty:this.EMPTY_CELL})}},{key:"checkEndGame",value:function(){for(var t=0;t<this.matrixState.value.length;t++)if(this.matrixState.value[t][19].exist){this.setGameOver();break}}},{key:"cleanRows",value:function(){for(var t=this,e=this.matrixState.copy(),n=function(n){for(var i=0,o=0;o<e.length;o++)e[o][n].exist&&i++;10===i&&(e=e.map(function(e){return Array.prototype.concat(e.slice(0,n),e.slice(n+1,e.length),[t.EMPTY_CELL])}),t.score.increase(1),n--),r=n},r=0;r<e[0].length;r++)n(r);this.matrixState=new h(null,null,this.EMPTY_CELL,e)}},{key:"insertTetromino",value:function(t,e){for(var n=e.matrix.value,r=e.column,i=e.row,o=t,a=0;a<n.length;a++)for(var s=0;s<n[a].length;s++)n[a][s].exist&&(o[r+a][i+s]=n[a][s]);return o}},{key:"isValidMove",value:function(t,e,n){for(var r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){if(e+r>=this.matrixState.value.length||n+i>=this.matrixState.value[0].length||e+r<0||n+i<0)return!1;if(t[r][i].exist&&this.matrixState.value[e+r][n+i].exist)return!1}return!0}},{key:"rotate",value:function(){this.canMove&&(this.tetromino.rotateRight(),this.isValidMove(this.tetromino.matrix.value,this.tetromino.column,this.tetromino.row)?Ct(At,this,Ht).call(this):this.tetromino.rotateLeft())}},{key:"moveToLeft",value:function(){this.canMove&&this.isValidMove(this.tetromino.matrix.value,this.tetromino.column-1,this.tetromino.row)&&(this.tetromino.toLeft(),Ct(At,this,Ht).call(this))}},{key:"moveToRight",value:function(){this.canMove&&this.isValidMove(this.tetromino.matrix.value,this.tetromino.column+1,this.tetromino.row)&&(this.tetromino.toRight(),Ct(At,this,Ht).call(this))}},{key:"moveToDown",value:function(){this.canMove&&this.isValidMove(this.tetromino.matrix.value,this.tetromino.column,this.tetromino.row-1)&&(this.tetromino.toDown(),Ct(At,this,Ht).call(this))}},{key:"start",value:function(){Rt(n,"start",this,3)([]),this.interval=setInterval(Ct(At,this,Gt).bind(this),this.SPEED_RATE)}},{key:"setGameOver",value:function(){Rt(n,"setGameOver",this,3)([]);var t=this.score.value,e=this.timer.value;this.rating.add(t,e),this.drawRating()}},{key:"clear",value:function(){Rt(n,"clear",this,3)([]),Ct(At,this,Dt).call(this)}},{key:"drawRating",value:function(){this.$RATING.innerHTML="";for(var t=this.rating.value,e=0;e<t.length&&e<10;e++){var n=document.createElement("tr"),r=document.createElement("td"),i=document.createElement("td"),o=document.createElement("td"),a=document.createElement("td"),s=new Date(t[e].date);r.innerText=e+1,i.innerText=t[e].score,o.innerText=t[e].time,a.innerText=s.toLocaleDateString(),n.append(r,i,o,a),this.$RATING.appendChild(n)}}}],i&&xt(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(s);function Dt(){this.isSettled=!1,this.$DIALOG.innerHTML="Let's have fun!",this.rating=new $(this.KEY_RATING),this.drawRating(),this.timer=new L,this.score=new _,this.matrixState=new h(this.MATRIX_WIDTH,this.MATRIX_HEIGHT,this.EMPTY_CELL),this.matrixRender=this.matrixState.clone(),this.matrixDraw=this.matrixRender.clone(),this.matrixDraw.crop({x:0,y:0},{x:this.MAP_WIDTH,y:this.MAP_HEIGHT}),this.matrixDraw.reflectY(),this.drawer=new g(this.$MAP,this.matrixDraw.value),this.tetromino=this.getTetromino()}function Gt(){Ct(At,this,Yt).call(this),Ct(At,this,Ht).call(this),Ct(At,this,Nt).call(this)}function Yt(){this.matrixRender=new h(null,null,this.EMPTY_CELL,this.insertTetromino(this.matrixState.copy(),this.tetromino))}function Ht(){this.$SCORE.innerText="Score: ".concat(this.score.value),this.$TIMER.innerText="Time: ".concat(this.timer.value),this.matrixDraw=this.matrixRender.clone(),this.matrixDraw.crop({x:0,y:0},{x:this.MAP_WIDTH,y:this.MAP_HEIGHT}),this.matrixDraw.reflectY(),this.drawer.matrix=this.matrixDraw.value,this.drawer.draw()}function Nt(){this.checkEndGame(),this.isGameOver&&(this.$DIALOG.innerHTML="Game Over!",clearInterval(this.interval)),this.isValidMove(this.tetromino.matrix.value,this.tetromino.column,this.tetromino.row-1)?this.tetromino.row--:(this.matrixState=new h(null,null,this.EMPTY_CELL,this.insertTetromino(this.matrixState.copy(),this.tetromino)),this.cleanRows(),this.settled=!0),this.settled&&(this.tetromino=this.getTetromino(),this.settled=!1)}function Wt(){this.keyboard=new X(this),this.gamepad=new st(this),this.touchscreen=new vt(this,this.$MAP)}function $t(){this.MATRIX_WIDTH=10,this.MATRIX_HEIGHT=25,this.MAP_WIDTH=10,this.MAP_HEIGHT=20,this.EMPTY_CELL={exist:!1,color:{light:"#F5F5F5",dark:"#055159"}}}function Ut(){this.$MAP=document.querySelector("#map"),this.$DIALOG=document.querySelector("#dialog"),this.$SCORE=document.querySelector("#score"),this.$TIMER=document.querySelector("#timer"),this.$RATING=document.querySelector("#rating")}new It({speedRate:250,keyRating:"es:tetris"}).start()})();